# üìä Peer Group Crosstab Report - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

**Peer Group Crosstab Report** ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á items ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (Peer Comparison) ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Crosstab/Pivot Table

### ‚ú® ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô
- üìà ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
- üé® ‡∏ó‡∏≤‡∏™‡∏µ cell ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô outlier ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
- üîç ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö peers
- üìä ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

---

## üîÑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Time Series Crosstab

| Feature | **Crosstab_Report**<br>(Time Series) | **Peer_Crosstab_Report**<br>(Peer Group) |
|---------|--------------------------------------|------------------------------------------|
| **‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö** | ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á | ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô |
| **Dimensions** | `CROSSTAB_DIMENSIONS`<br>(‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° item ID) | `AUDIT_PEER_GROUP_BY` + `AUDIT_PEER_ITEM_ID`<br>(‡∏£‡∏ß‡∏° item ID) |
| **‡πÅ‡∏ñ‡∏ß (Rows)** | GROUP + GL Code | GROUP + GL Code + Cost Center |
| **‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö** | Rolling Window (6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô) | IsolationForest |
| **Anomaly Types** | ‚Ä¢ High/Low Spike<br>‚Ä¢ Negative Value | ‚Ä¢ High Outlier vs Peers<br>‚Ä¢ Low Outlier vs Peers |
| **‡∏™‡∏µ Legend** | üî¥ High Spike<br>üü° Low Drop<br>‚ö´ Negative | üî¥ High Outlier<br>üü° Low Outlier |

---

## üéØ Use Cases

### ‚úÖ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:

1. **‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Cost Center ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô**
   ```
   ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: GL "‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á"
   - Cost Center A: 500,000 ‡∏ö‡∏≤‡∏ó
   - Cost Center B: 120,000 ‡∏ö‡∏≤‡∏ó
   - Cost Center C: 100,000 ‡∏ö‡∏≤‡∏ó
   - Cost Center D: 110,000 ‡∏ö‡∏≤‡∏ó

   ‚Üí Cost Center A ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ó‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á (High Outlier)
   ```

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≥‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥**
   ```
   ‡∏≠‡∏≤‡∏à‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ß‡πà‡∏≤:
   - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
   - ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
   - ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   ```

3. **‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô**
   ```
   ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏´‡∏ô‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
   ```

### ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:

- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ ‚Üí ‡πÉ‡∏ä‡πâ Time Series Crosstab ‡πÅ‡∏ó‡∏ô
- GL ‡∏ó‡∏µ‡πà‡∏°‡∏µ Cost Center ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ peers ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö

---

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

### 1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Peer Group Analysis

```python
# main_audit.py

# ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Peer Group Analysis
RUN_PEER_GROUP_ANALYSIS = True

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ dimensions ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Peer Group
AUDIT_PEER_GROUP_BY = ["GROUP_NAME", "GL_CODE", "GL_NAME_NT1"]
AUDIT_PEER_ITEM_ID = "COST_CENTER_DEPARTMENT"
```

### 2. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à Dimensions

```python
# Dimensions ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Peer Group
AUDIT_PEER_GROUP_BY = ["GROUP_NAME", "GL_CODE", "GL_NAME_NT1"]
AUDIT_PEER_ITEM_ID = "COST_CENTER_DEPARTMENT"

# ‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°:
# - ‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏° GROUP_NAME, GL_CODE, GL_NAME_NT1
# - ‡∏à‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á COST_CENTER_DEPARTMENT ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°:**

```
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 1:
  GROUP_NAME: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á"
  GL_CODE: "51642101"
  GL_NAME_NT1: "‡∏ï-‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á"

  Peers ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°:
  - COST_CENTER_DEPARTMENT: "CC001-DEPT_A" ‚Üí 500,000
  - COST_CENTER_DEPARTMENT: "CC002-DEPT_B" ‚Üí 120,000
  - COST_CENTER_DEPARTMENT: "CC003-DEPT_C" ‚Üí 100,000

  ‚Üí CC001 ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô outlier
```

---

## üìä ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Crosstab Report

### ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á

```
| GROUP_NAME | GL_CODE  | GL_NAME_NT1      | COST_CENTER | 2025-01 | 2025-02 | 2025-03 | ...
|------------|----------|------------------|-------------|---------|---------|---------|
| ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á  | 51642101 | ‡∏ï-‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á      | CC001-DEPT_A| 500,000 | 480,000 | 520,000 |
| ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á  | 51642101 | ‡∏ï-‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á      | CC002-DEPT_B| 120,000 | 115,000 | 118,000 |
| ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á  | 51642101 | ‡∏ï-‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á      | CC003-DEPT_C| 100,000 |  98,000 | 102,000 |
```

### ‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏™‡∏µ

- üî¥ **‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏≠‡πà‡∏≠‡∏ô** (High Outlier) - ‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
- üü° **‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á** (Low Outlier) - ‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô

---

## üîç ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Anomaly

### Isolation Forest Algorithm

‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ **IsolationForest** ‡∏à‡∏≤‡∏Å scikit-learn ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö outliers:

1. **‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°** ‡∏ï‡∏≤‡∏° `AUDIT_PEER_GROUP_BY`
2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô** (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà time series)
3. **‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°** ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á items
4. **‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Z-Score** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
   - ‡∏ñ‡πâ‡∏≤ `|Z-Score| > 2.0` ‚Üí ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô anomaly

### ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î

- **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô items ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥:** 5 items ‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°
  - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 5 ‡∏à‡∏∞‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏±‡πâ‡∏ô
- **Contamination:** 0.05 (5%)
  - ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤ 5% ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô outlier

---

## üìà ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

### Scenario 1: ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á

```python
# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
AUDIT_PEER_GROUP_BY = ["GROUP_NAME", "GL_CODE"]
AUDIT_PEER_ITEM_ID = "COST_CENTER"
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
```
GL: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®"
Peers:
- Finance Dept:     150,000 ‡∏ö‡∏≤‡∏ó
- HR Dept:          120,000 ‡∏ö‡∏≤‡∏ó
- IT Dept:          800,000 ‡∏ö‡∏≤‡∏ó ‚Üê üî¥ High Outlier
- Marketing Dept:   130,000 ‡∏ö‡∏≤‡∏ó
```

**‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°:**
- IT Dept ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏Å
- ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

---

### Scenario 2: ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°

```python
# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
AUDIT_PEER_GROUP_BY = ["GROUP_NAME", "GL_CODE", "REGION"]
AUDIT_PEER_ITEM_ID = "BRANCH_CODE"
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
```
GL: "‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£" | Region: "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û"
Peers (‡∏™‡∏≤‡∏Ç‡∏≤):
- Branch 001:  500,000 ‡∏ö‡∏≤‡∏ó
- Branch 002:  480,000 ‡∏ö‡∏≤‡∏ó
- Branch 003:   50,000 ‡∏ö‡∏≤‡∏ó ‚Üê üü° Low Outlier
- Branch 004:  520,000 ‡∏ö‡∏≤‡∏ó
```

**‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°:**
- Branch 003 ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏ï‡πà‡∏≥‡∏°‡∏≤‡∏Å
- ‡∏≠‡∏≤‡∏à‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ:
  - ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°
  - ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢
  - ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô

---

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

### 1. Dimension Configuration

**‚ùå ‡∏ú‡∏¥‡∏î:**
```python
# df_peer_log ‡∏°‡∏µ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ['GROUP_NAME', 'GL_CODE']
# ‡πÅ‡∏ï‡πà config ‡πÄ‡∏õ‡πá‡∏ô:
AUDIT_PEER_GROUP_BY = ["GROUP_NAME", "GL_CODE", "GL_NAME_NT1"]
AUDIT_PEER_ITEM_ID = "COST_CENTER"
```

**‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:**
```python
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ dimensions ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
# ‡∏î‡∏π‡πÉ‡∏ô output console:
[Reporter]:    ‚ö† Warning: df_peer_log missing dimensions: ['GL_NAME_NT1']
```

### 2. Peer Group ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

- Peer group ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏õ‡∏Å‡∏ï‡∏¥)
- ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏à‡∏∞‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô

```
‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 1: ‡∏°‡∏µ 10 cost centers ‚Üí avg = 100K
‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 2: ‡∏°‡∏µ 15 cost centers ‚Üí avg = 80K (‡∏°‡∏µ cost center ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤)
```

### 3. NaN Values

- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏õ‡∏•‡∏á NaN ‡πÄ‡∏õ‡πá‡∏ô 'N/A' ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö `prepare_data()` function

---

## üêõ Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ Peer_Crosstab_Report sheet

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
1. `RUN_PEER_GROUP_ANALYSIS = False`
2. ‡πÑ‡∏°‡πà‡∏°‡∏µ peer anomalies ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
3. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô peers ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 5 items

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```python
# 1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô peer group analysis
RUN_PEER_GROUP_ANALYSIS = True

# 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö output console:
[Engine]:    ‚úì Peer Group: Found XX anomalies

# 3. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠ "No anomalies detected" ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
```

---

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Cell ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ó‡∏≤‡∏™‡∏µ

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Dimension ‡πÑ‡∏°‡πà match ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á `df_peer_log` ‡πÅ‡∏•‡∏∞ `df_report`

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```bash
# ‡∏î‡∏π‡πÉ‡∏ô console output:
[Reporter]:    ‚ö† Warning: df_peer_log missing dimensions: [...]
[Reporter]:    Available columns: [...]
[Reporter]:    Skipping peer crosstab highlighting.
```

---

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏°‡∏µ anomalies ‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Contamination parameter ‡∏≠‡∏≤‡∏à‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô `anomaly_engine.py` line 265:
```python
# ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 0.05 (5%) ‡πÄ‡∏õ‡πá‡∏ô 0.10 (10%)
clf = IsolationForest(contamination=0.10, random_state=42)
```

---

## üìù Best Practices

### 1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Dimensions ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

```python
# ‡∏î‡∏µ: ‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô peers ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠
AUDIT_PEER_GROUP_BY = ["GL_CODE"]
AUDIT_PEER_ITEM_ID = "COST_CENTER"  # ‡∏°‡∏µ 50 cost centers

# ‡πÑ‡∏°‡πà‡∏î‡∏µ: peers ‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
AUDIT_PEER_GROUP_BY = ["GL_CODE", "REGION", "PRODUCT"]
AUDIT_PEER_ITEM_ID = "BRANCH"  # ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏µ 2-3 branches
```

### 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Full_Audit_Log

```python
# ‡∏î‡∏π Crosstab ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
‚Üí Peer_Crosstab_Report

# ‡∏î‡∏π Log ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
‚Üí Full_Audit_Log (Peer)
  - ‡∏°‡∏µ Z-Score
  - ‡∏°‡∏µ Group Average
  - ‡∏°‡∏µ COMPARED_WITH
```

### 3. ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Time Series Crosstab

```
‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 1: ‡∏î‡∏π Crosstab_Report
           ‚Üí ‡∏´‡∏≤ High/Low Spike (‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤)

‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 2: ‡∏î‡∏π Peer_Crosstab_Report
           ‚Üí ‡∏´‡∏≤ Outliers (‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô)

‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 3: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á report
           ‚Üí ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
```

---

## üîó ‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

- [README.md](README.md) - ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
- [MAIN_AUDIT_USAGE_GUIDE.md](MAIN_AUDIT_USAGE_GUIDE.md) - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô main_audit.py
- [CONFIGURATION_GUIDE.md](CONFIGURATION_GUIDE.md) - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢:** Claude
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 2025-11-18
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** v4.2.0
