# Revenue ETL System v2.1

## à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸²à¸¢à¹„à¸”à¹‰à¹à¸šà¸š Modular à¸à¸£à¹‰à¸­à¸¡ Web Interface

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-Proprietary-red.svg)]()
[![Version](https://img.shields.io/badge/version-2.1.0-green.svg)]()

---

## ğŸ“‹ à¸ à¸²à¸à¸£à¸§à¸¡à¸£à¸°à¸šà¸š

Revenue ETL System à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸²à¸¢à¹„à¸”à¹‰à¸—à¸µà¹ˆà¸­à¸­à¸à¹à¸šà¸šà¸¡à¸²à¹€à¸›à¹‡à¸™ **Modular Architecture** à¸à¸£à¹‰à¸­à¸¡à¸£à¸°à¸šà¸š **Configuration Management** à¸—à¸µà¹ˆà¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™ à¹à¸¥à¸° **Web Interface** à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸‡à¹ˆà¸²à¸¢ à¸—à¸³à¹ƒà¸«à¹‰à¸ªà¸²à¸¡à¸²à¸£à¸–à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¹à¸¥à¸°à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹„à¸”à¹‰à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚à¹‚à¸„à¹‰à¸”

### âœ¨ à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´à¸«à¸¥à¸±à¸

#### ğŸ¯ Core Features
- âœ… **Configuration Management** - à¸ˆà¸±à¸”à¸à¸²à¸£ config à¸œà¹ˆà¸²à¸™à¹„à¸Ÿà¸¥à¹Œ JSON à¹à¸šà¸š centralized
- âœ… **Modular Design** - à¹à¸¢à¸ module à¸Šà¸±à¸”à¹€à¸ˆà¸™ (FI, ETL, Reconciliation) à¸‡à¹ˆà¸²à¸¢à¸•à¹ˆà¸­à¸à¸²à¸£à¸šà¸³à¸£à¸¸à¸‡à¸£à¸±à¸à¸©à¸²
- âœ… **Cross-Platform Support** - à¸£à¸­à¸‡à¸£à¸±à¸š Windows, macOS, Linux à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
- âœ… **Web Application** - UI à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸‡à¹ˆà¸²à¸¢ à¸ªà¸£à¹‰à¸²à¸‡à¸”à¹‰à¸§à¸¢ Streamlit
- âœ… **Command Line Interface** - à¸£à¸­à¸‡à¸£à¸±à¸šà¸à¸²à¸£à¸£à¸±à¸™à¸œà¹ˆà¸²à¸™ CLI à¸à¸£à¹‰à¸­à¸¡ options à¸•à¹ˆà¸²à¸‡à¹†

#### ğŸ“Š Data Processing Features
- âœ… **FI Module** - à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸‡à¸šà¸à¸²à¸£à¹€à¸‡à¸´à¸™ (Financial Income Statement)
- âœ… **ETL Pipeline** - à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥ Transaction Revenue à¹à¸šà¸š end-to-end
- âœ… **Data Reconciliation** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸§à¸²à¸¡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ FI à¹à¸¥à¸° Transaction
- âœ… **Anomaly Detection** - à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¸„à¸§à¸²à¸¡à¸œà¸´à¸”à¸›à¸à¸•à¸´à¸‚à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ 4 à¸£à¸°à¸”à¸±à¸š
- âœ… **Business Rules Engine** - à¸à¸à¸—à¸²à¸‡à¸˜à¸¸à¸£à¸à¸´à¸ˆà¸—à¸µà¹ˆà¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¹„à¸”à¹‰

#### ğŸ”§ Advanced Features
- âœ… **Logging System** - à¸šà¸±à¸™à¸—à¸¶à¸ log à¹à¸šà¸š structured à¸à¸£à¹‰à¸­à¸¡ rotation
- âœ… **Error Handling** - à¸ˆà¸±à¸”à¸à¸²à¸£ errors à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸š à¸à¸£à¹‰à¸­à¸¡ error files
- âœ… **Template Support** - à¸Šà¸·à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œà¹à¸šà¸š dynamic (YYYY, MM, DD)
- âœ… **Month Sync** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸¥à¸° sync à¹€à¸”à¸·à¸­à¸™à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ FI à¹à¸¥à¸° ETL à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
- âœ… **Progress Tracking** - à¹à¸ªà¸”à¸‡à¸„à¸§à¸²à¸¡à¸„à¸·à¸šà¸«à¸™à¹‰à¸²à¹à¸šà¸š real-time

---

## ğŸ—ï¸ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸£à¸°à¸šà¸š

### System Architecture

```
Revenue ETL System v2.1
â”‚
â”œâ”€â”€â”€ Configuration Layer
â”‚    â””â”€â”€ config.json (Centralized Configuration)
â”‚
â”œâ”€â”€â”€ Core Modules
â”‚    â”œâ”€â”€ FI Module (Financial Income Statement Processing)
â”‚    â”œâ”€â”€ ETL Module (Revenue ETL Pipeline)
â”‚    â””â”€â”€ Reconciliation Module (Data Validation)
â”‚
â”œâ”€â”€â”€ Interface Layer
â”‚    â”œâ”€â”€ CLI (main.py)
â”‚    â””â”€â”€ Web UI (web_app.py)
â”‚
â””â”€â”€â”€ Support Layer
     â”œâ”€â”€ Config Manager (Configuration Management)
     â”œâ”€â”€ Logger Utils (Logging System)
     â””â”€â”€ Error Handling (Exception Management)
```

### à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸™à¸£à¸°à¸šà¸š

```
revenue-report/
â”‚
â”œâ”€â”€ ğŸ“‹ Configuration
â”‚   â””â”€â”€ config.json                    # à¹„à¸Ÿà¸¥à¹Œ configuration à¸«à¸¥à¸±à¸
â”‚
â”œâ”€â”€ ğŸ® Main Applications
â”‚   â”œâ”€â”€ main.py                        # CLI Application
â”‚   â””â”€â”€ web_app.py                     # Web Application (Streamlit)
â”‚
â”œâ”€â”€ ğŸ”§ Core Modules
â”‚   â”œâ”€â”€ config_manager.py              # Configuration Manager
â”‚   â”œâ”€â”€ fi_revenue_expense_module.py   # FI Processing Module
â”‚   â”œâ”€â”€ revenue_etl_report.py          # ETL Pipeline Module
â”‚   â”œâ”€â”€ revenue_reconciliation.py      # Reconciliation Module
â”‚   â””â”€â”€ logger_utils.py                # Logging Utilities
â”‚
â”œâ”€â”€ ğŸ“š Documentation
â”‚   â”œâ”€â”€ README.md                      # à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸«à¸¥à¸±à¸ (à¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰)
â”‚   â””â”€â”€ SETUP_GUIDE.md                 # à¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸°à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²
â”‚
â”œâ”€â”€ ğŸ“¦ Dependencies
â”‚   â””â”€â”€ requirements.txt               # Python packages
â”‚
â””â”€â”€ ğŸ“ Runtime (Generated)
    â””â”€â”€ logs/                          # Log files
        â”œâ”€â”€ system_YYYYMMDD.log
        â”œâ”€â”€ fi_module_YYYYMMDD.log
        â”œâ”€â”€ etl_module_YYYYMMDD.log
        â””â”€â”€ config_manager_YYYYMMDD.log
```

---

## ğŸš€ Quick Start

### à¸‚à¹‰à¸­à¸à¸³à¸«à¸™à¸”à¸£à¸°à¸šà¸š

- **Python:** 3.8 à¸«à¸£à¸·à¸­à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²
- **RAM:** à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 4 GB
- **Disk Space:** à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 2 GB à¸ªà¸³à¸«à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸° logs
- **OS:** Windows 10+, macOS 10.14+, à¸«à¸£à¸·à¸­ Linux

### à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸šà¸šà¹€à¸£à¹‡à¸§

```bash
# 1. Clone à¸«à¸£à¸·à¸­ download repository
cd revenue-report

# 2. à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
pip install -r requirements.txt

# 3. à¹à¸à¹‰à¹„à¸‚ config.json à¸•à¸²à¸¡à¸£à¸°à¸šà¸šà¸‚à¸­à¸‡à¸„à¸¸à¸“
# (à¸”à¸¹ SETUP_GUIDE.md à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”)

# 4. à¸£à¸±à¸™à¸£à¸°à¸šà¸š
python main.py
```

---

## ğŸ’» à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™

### 1. Command Line Interface (CLI)

#### à¸£à¸±à¸™à¸£à¸°à¸šà¸šà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” (FI + ETL)
```bash
python main.py
```

#### à¸£à¸±à¸™à¹€à¸‰à¸à¸²à¸° FI Module
```bash
python main.py --module fi
```

#### à¸£à¸±à¸™à¹€à¸‰à¸à¸²à¸° ETL Module
```bash
python main.py --module etl
```

#### à¸£à¸°à¸šà¸¸à¹„à¸Ÿà¸¥à¹Œ config
```bash
python main.py --config custom_config.json
```

#### Override à¹€à¸”à¸·à¸­à¸™
```bash
python main.py --month 10
```
> **Note:** à¹€à¸”à¸·à¸­à¸™à¸ˆà¸°à¸–à¸¹à¸ sync à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ FI à¹à¸¥à¸° ETL à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´

### 2. Web Application

#### à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ Web Server
```bash
streamlit run web_app.py
```

#### à¹€à¸›à¸´à¸” Browser
```
http://localhost:8501
```

#### à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´à¹ƒà¸™ Web App

**ğŸ“Š Dashboard Tab**
- à¹à¸ªà¸”à¸‡à¸ªà¸–à¸²à¸™à¸°à¸£à¸°à¸šà¸šà¹à¸šà¸š real-time
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š master files à¹à¸¥à¸° output files
- à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸”à¸·à¸­à¸™ FI à¹à¸¥à¸° ETL à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸™
- à¹à¸ªà¸”à¸‡ configuration overview

**ğŸ“ FI Module Tab**
- à¹à¸ªà¸”à¸‡ configuration à¸‚à¸­à¸‡ FI module
- à¸£à¸±à¸™ FI processing à¸œà¹ˆà¸²à¸™ UI
- à¹à¸ªà¸”à¸‡à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¸à¸£à¹‰à¸­à¸¡à¸à¸£à¸²à¸Ÿ Summary
- à¸”à¸¹ FI output files

**ğŸ”„ ETL Module Tab**
- à¹à¸ªà¸”à¸‡ pipeline steps à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸„à¸·à¸šà¸«à¸™à¹‰à¸²
- à¹à¸ªà¸”à¸‡ business rules à¹à¸¥à¸° special mappings
- à¹à¸ªà¸”à¸‡ reconciliation à¹à¸¥à¸° anomaly detection settings
- à¸£à¸±à¸™ ETL processing à¸œà¹ˆà¸²à¸™ UI

**âœ… Reconciliation Tab**
- à¹à¸ªà¸”à¸‡à¸œà¸¥ reconciliation à¸ˆà¸²à¸ log files à¸ˆà¸£à¸´à¸‡
- à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸š FI vs TRN (Monthly à¹à¸¥à¸° YTD)
- à¹à¸ªà¸”à¸‡ validation results
- à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸” error files

**ğŸ“ˆ Analytics Tab**
- à¹à¸ªà¸”à¸‡ Anomaly Detection Results (4 levels)
- à¸à¸£à¸²à¸Ÿ Revenue Trends à¸ˆà¸²à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡
- à¸à¸£à¸²à¸Ÿ Revenue by Business Group
- à¸ªà¸–à¸´à¸•à¸´à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹‚à¸”à¸¢à¸£à¸§à¸¡

**ğŸ“‹ Logs Tab**
- à¹à¸ªà¸”à¸‡ log files à¹à¸šà¸š real-time
- à¸à¸£à¸­à¸‡ logs à¸•à¸²à¸¡ level (ERROR, WARNING, INFO, etc.)
- à¸„à¹‰à¸™à¸«à¸²à¹ƒà¸™ logs
- à¹à¸ªà¸”à¸‡ error files à¸à¸£à¹‰à¸­à¸¡à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”

**âš™ï¸ Configuration Editor (Sidebar)**
- à¹à¸à¹‰à¹„à¸‚ Processing Year/Month
- à¸›à¸£à¸±à¸š Reconciliation settings
- à¸›à¸£à¸±à¸š Anomaly Detection parameters
- Sync à¹€à¸”à¸·à¸­à¸™à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ FI à¹à¸¥à¸° ETL

---

## âš™ï¸ Configuration

### Overview

à¸£à¸°à¸šà¸šà¹ƒà¸Šà¹‰à¹„à¸Ÿà¸¥à¹Œ `config.json` à¹€à¸›à¹‡à¸™ central configuration à¹‚à¸”à¸¢à¹à¸šà¹ˆà¸‡à¹€à¸›à¹‡à¸™ sections à¸«à¸¥à¸±à¸à¹† à¸”à¸±à¸‡à¸™à¸µà¹‰:

1. **Environment & Paths** - à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸·à¹‰à¸™à¸à¸²à¸™à¹à¸¥à¸° paths à¸•à¸²à¸¡ OS
2. **Processing Settings** - à¸›à¸µà¹à¸¥à¸°à¹€à¸”à¸·à¸­à¸™à¸—à¸µà¹ˆà¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥
3. **FI Module** - à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸ªà¸³à¸«à¸£à¸±à¸š FI processing
4. **ETL Module** - à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸ªà¸³à¸«à¸£à¸±à¸š ETL pipeline
5. **Logging** - à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² logging system

> **à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸„à¸£à¸šà¸–à¹‰à¸§à¸™à¸‚à¸­à¸‡ config.json à¹‚à¸›à¸£à¸”à¸”à¸¹à¸—à¸µà¹ˆ [SETUP_GUIDE.md](SETUP_GUIDE.md#-configuration-reference)**

---

## ğŸ“Š à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥

### Phase 1: FI Revenue Expense Processing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Load Master Files                               â”‚
â”‚     â”œâ”€â”€ MASTER_EXPENSE_GL_CODE                      â”‚
â”‚     â”œâ”€â”€ MASTER_REVENUE_GL_CODE                      â”‚
â”‚     â”œâ”€â”€ MASTER_OTHER_REVENUE_NET                    â”‚
â”‚     â””â”€â”€ master_revenue_expense_net                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Read Input File                                 â”‚
â”‚     â””â”€â”€ pld_nt_{YYYYMMDD}.txt (TIS-620 encoding)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Process Expense                                 â”‚
â”‚     â”œâ”€â”€ Filter GL codes (51, 53, 54, 59, 52)       â”‚
â”‚     â”œâ”€â”€ Map with MASTER_EXPENSE                     â”‚
â”‚     â””â”€â”€ Group by CODE_GROUP                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. Process Revenue                                 â”‚
â”‚     â”œâ”€â”€ Filter GL codes (4x)                        â”‚
â”‚     â”œâ”€â”€ Map with MASTER_REVENUE                     â”‚
â”‚     â”œâ”€â”€ Separate Other Revenue                      â”‚
â”‚     â””â”€â”€ Process Financial Income                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5. Generate Excel Report                           â”‚
â”‚     â””â”€â”€ pl_combined_output_{YYYYMM}.xlsx            â”‚
â”‚         â”œâ”€â”€ Sheet: expense_nt                       â”‚
â”‚         â”œâ”€â”€ Sheet: revenue_nt                       â”‚
â”‚         â””â”€â”€ Sheet: summary_other                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Output Files:**
- `pl_combined_output_{YYYYMM}.xlsx` - à¸£à¸²à¸¢à¸‡à¸²à¸™ Excel à¸£à¸§à¸¡
- `pl_expense_nt_output_{YYYYMM}.csv` - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Expense (UTF-8)
- `pl_revenue_nt_output_{YYYYMM}.csv` - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Revenue (UTF-8)

### Phase 2: Revenue ETL Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 0: Reconciliation (Optional)                  â”‚
â”‚     â”œâ”€â”€ Compare FI vs TRN (Monthly)                 â”‚
â”‚     â”œâ”€â”€ Compare FI vs TRN (YTD)                     â”‚
â”‚     â””â”€â”€ Generate reconciliation logs                â”‚
â”‚         â”œâ”€â”€ reconcile_summary_{timestamp}.txt       â”‚
â”‚         â”œâ”€â”€ reconcile_monthly_errors_{timestamp}.csvâ”‚
â”‚         â””â”€â”€ reconcile_ytd_errors_{timestamp}.csv    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STEP 1: Concatenate CSV Files                      â”‚
â”‚     â”œâ”€â”€ TRN_REVENUE_NT1_*.csv                       â”‚
â”‚     â”œâ”€â”€ TRN_REVENUE_ADJ_GL_NT1_*.csv                â”‚
â”‚     â”œâ”€â”€ TRN_REVENUE_ADJ_*.csv                       â”‚
â”‚     â””â”€â”€ Output: trn_revenue_nt_2025.csv             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STEP 2: Map Cost Center                            â”‚
â”‚     â”œâ”€â”€ Read MAPPING_CC.csv                         â”‚
â”‚     â”œâ”€â”€ Map COST_CENTER_OLD â†’ COST_CENTER_NEW       â”‚
â”‚     â””â”€â”€ Output: revenue_new_cc_2025.csv             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STEP 3: Map Product Codes                          â”‚
â”‚     â”œâ”€â”€ Read MAP_PRODUCT_NT_NEW_2024.csv            â”‚
â”‚     â”œâ”€â”€ Apply Special Mappings                      â”‚
â”‚     â”‚   â””â”€â”€ GSaaS to Other Revenue                  â”‚
â”‚     â””â”€â”€ Output: revenue_mapped_product_2025.csv     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STEP 4: Merge with Master Files                    â”‚
â”‚     â”œâ”€â”€ Merge with MASTER_PRODUCT                   â”‚
â”‚     â”œâ”€â”€ Merge with MASTER_REVENUE_GL_CODE           â”‚
â”‚     â”œâ”€â”€ Apply Business Rules                        â”‚
â”‚     â””â”€â”€ Generate error files                        â”‚
â”‚         â”œâ”€â”€ error_gl_REVENUE_NT_REPORT_2025.csv     â”‚
â”‚         â””â”€â”€ error_product_REVENUE_NT_REPORT_2025.csvâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STEP 5: Anomaly Detection (4 Levels)               â”‚
â”‚     â”œâ”€â”€ Product Level                               â”‚
â”‚     â”œâ”€â”€ Service Group Level                         â”‚
â”‚     â”œâ”€â”€ Business Group Level                        â”‚
â”‚     â””â”€â”€ Grand Total Level                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STEP 6: Generate Excel Report                      â”‚
â”‚     â””â”€â”€ REVENUE_NT_REPORT_2025.xlsx                 â”‚
â”‚         â”œâ”€â”€ All sheets with anomaly highlighting    â”‚
â”‚         â””â”€â”€ Pivot tables and charts                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Output Files:**
- `REVENUE_NT_REPORT_2025.xlsx` - à¸£à¸²à¸¢à¸‡à¸²à¸™à¸«à¸¥à¸±à¸ (Multi-sheet)
- `REVENUE_NT_REPORT_2025.csv` - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ CSV à¸£à¸§à¸¡
- `trn_revenue_nt_2025.csv` - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ transaction à¸£à¸§à¸¡
- `error_gl_*.csv` - GL codes à¸—à¸µà¹ˆà¸¡à¸µà¸›à¸±à¸à¸«à¸²
- `error_product_*.csv` - Product codes à¸—à¸µà¹ˆà¸¡à¸µà¸›à¸±à¸à¸«à¸²

---

## ğŸš¨ Troubleshooting

### Common Issues à¹à¸¥à¸°à¸§à¸´à¸˜à¸µà¹à¸à¹‰à¹„à¸‚

#### 1. âŒ Month Mismatch Error
```
ğŸš¨ à¹€à¸”à¸·à¸­à¸™à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸™! FI: 09, ETL: 10 â†’ Reconciliation à¸ˆà¸°à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§
```
**à¸ªà¸²à¹€à¸«à¸•à¸¸:** FI à¹à¸¥à¸° ETL à¹ƒà¸Šà¹‰à¹€à¸”à¸·à¸­à¸™à¹„à¸¡à¹ˆà¹€à¸—à¹ˆà¸²à¸à¸±à¸™
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
- **CLI:** à¹ƒà¸Šà¹‰ `--month 10` à¹€à¸à¸·à¹ˆà¸­ sync à¸—à¸±à¹‰à¸‡à¸„à¸¹à¹ˆ
- **Web App:** à¹„à¸›à¸—à¸µà¹ˆ Configuration Editor â†’ à¸à¸” "ğŸ”„ Sync à¹€à¸”à¸·à¸­à¸™à¹ƒà¸«à¹‰à¸•à¸£à¸‡à¸à¸±à¸™"

#### 2. âŒ Reconciliation Failed
```
âŒ Reconciliation à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ - à¸«à¸¢à¸¸à¸”à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™
```
**à¸ªà¸²à¹€à¸«à¸•à¸¸:** à¸¢à¸­à¸”à¸£à¸§à¸¡ FI à¹à¸¥à¸° TRN à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸™
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹ƒà¸Šà¹‰à¹€à¸”à¸·à¸­à¸™à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™
2. à¸”à¸¹ log files à¹ƒà¸™ `revenue/output/reconcile_logs/`
3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š tolerance à¹ƒà¸™ config
4. à¸à¸´à¸ˆà¸²à¸£à¸“à¸²à¸›à¸´à¸” reconciliation à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§ (`"enabled": false`)

#### 3. âŒ Master File Not Found
```
âŒ expense: MASTER_EXPENSE_GL_CODE_NT1_NT_20251028.csv (Not found)
```
**à¸ªà¸²à¹€à¸«à¸•à¸¸:** Path à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¸«à¸£à¸·à¸­à¹„à¸Ÿà¸¥à¹Œà¹„à¸¡à¹ˆà¸¡à¸µ
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸Ÿà¸¥à¹Œà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ `master_path/source/` (à¸ªà¸³à¸«à¸£à¸±à¸šà¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¡à¸µ "/" à¹ƒà¸™à¸Šà¸·à¹ˆà¸­)
2. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸Šà¸·à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¹‰à¸•à¸£à¸‡à¸à¸±à¸šà¹ƒà¸™ `config.json`
3. à¸”à¸¹ expected path à¹ƒà¸™ Web App Dashboard

#### 4. âŒ Encoding Error
```
UnicodeDecodeError: 'utf-8' codec can't decode
```
**à¸ªà¸²à¹€à¸«à¸•à¸¸:** Encoding à¸‚à¸­à¸‡à¹„à¸Ÿà¸¥à¹Œà¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¸—à¸µà¹ˆà¸£à¸°à¸šà¸¸
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
- à¹„à¸Ÿà¸¥à¹Œ FI input à¸„à¸§à¸£à¹€à¸›à¹‡à¸™ `tis-620`
- Master files à¸„à¸§à¸£à¹€à¸›à¹‡à¸™ `utf-8`
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š `fi_module.encoding` à¹ƒà¸™ config

#### 5. âŒ Permission Denied
```
PermissionError: [Errno 13] Permission denied
```
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡ folder
- à¸›à¸´à¸”à¹„à¸Ÿà¸¥à¹Œ Excel à¸—à¸µà¹ˆà¹€à¸›à¸´à¸”à¸­à¸¢à¸¹à¹ˆ
- à¹ƒà¸Šà¹‰ sudo (Linux/Mac) à¸«à¸£à¸·à¸­ Run as Administrator (Windows) à¸–à¹‰à¸²à¸ˆà¸³à¹€à¸›à¹‡à¸™

---

## ğŸ“ Output Files Reference

### FI Module Outputs

**Location:** `{base_path}/{year}/fi/output/`

| à¹„à¸Ÿà¸¥à¹Œ | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” |
|------|-----------|
| `pl_combined_output_{YYYYMM}.xlsx` | à¸£à¸²à¸¢à¸‡à¸²à¸™ Excel à¸£à¸§à¸¡ 3 sheets |
| `pl_expense_nt_output_{YYYYMM}.csv` | à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Expense (UTF-8) |
| `pl_revenue_nt_output_{YYYYMM}.csv` | à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Revenue (UTF-8) à¸ªà¸³à¸«à¸£à¸±à¸š reconciliation |

### ETL Module Outputs

**Location:** `{base_path}/{year}/revenue/output/`

| à¹„à¸Ÿà¸¥à¹Œ | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” |
|------|-----------|
| `trn_revenue_nt_{YYYY}.csv` | à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ transaction à¸£à¸§à¸¡à¸—à¸¸à¸à¹€à¸”à¸·à¸­à¸™ |
| `revenue_new_cc_{YYYY}.csv` | à¸«à¸¥à¸±à¸‡ map cost center |
| `revenue_mapped_product_{YYYY}_.csv` | à¸«à¸¥à¸±à¸‡ map product |

**Location:** `{base_path}/all/revenue/{year}/`

| à¹„à¸Ÿà¸¥à¹Œ | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” |
|------|-----------|
| `REVENUE_NT_REPORT_{YYYY}.xlsx` | à¸£à¸²à¸¢à¸‡à¸²à¸™à¸«à¸¥à¸±à¸ (Multi-sheet) à¸à¸£à¹‰à¸­à¸¡ anomaly detection |
| `REVENUE_NT_REPORT_{YYYY}.csv` | à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ CSV à¸£à¸§à¸¡ |
| `error_gl_REVENUE_NT_REPORT_{YYYY}.csv` | GL codes à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸à¸šà¹ƒà¸™ master |
| `error_product_REVENUE_NT_REPORT_{YYYY}.csv` | Product codes à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸à¸šà¹ƒà¸™ master |

### Reconciliation Outputs

**Location:** `{base_path}/{year}/revenue/output/reconcile_logs/`

| à¹„à¸Ÿà¸¥à¹Œ | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” |
|------|-----------|
| `reconcile_summary_{YYYY}_{timestamp}.txt` | à¸ªà¸£à¸¸à¸›à¸œà¸¥à¸à¸²à¸£ reconcile |
| `reconcile_monthly_errors_{YYYY}_{timestamp}.csv` | à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸µà¹ˆà¹à¸•à¸à¸•à¹ˆà¸²à¸‡ (Monthly) |
| `reconcile_ytd_errors_{YYYY}_{timestamp}.csv` | à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸µà¹ˆà¹à¸•à¸à¸•à¹ˆà¸²à¸‡ (YTD) |

---

## ğŸ”„ Version History

### v2.1.0 (Current - November 2025)
- âœ¨ à¹€à¸à¸´à¹ˆà¸¡ Web Application à¸à¸£à¹‰à¸­à¸¡ UI à¸—à¸µà¹ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ
- âœ¨ à¸£à¸°à¸šà¸šà¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸¥à¸° sync à¹€à¸”à¸·à¸­à¸™à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
- âœ¨ à¹à¸ªà¸”à¸‡ Reconciliation Results à¸ˆà¸²à¸ log files à¸ˆà¸£à¸´à¸‡
- âœ¨ à¹à¸ªà¸”à¸‡ Anomaly Detection Results à¹à¸šà¸š interactive
- âœ¨ Configuration Editor à¹ƒà¸™ Web UI
- âœ¨ Real-time progress tracking
- ğŸ› à¹à¸à¹‰à¹„à¸‚ path handling à¸ªà¸³à¸«à¸£à¸±à¸š master files
- ğŸ› à¹à¸à¹‰à¹„à¸‚ reconciliation parsing
- ğŸ“š à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡à¹€à¸­à¸à¸ªà¸²à¸£à¹ƒà¸«à¹‰à¸„à¸£à¸šà¸–à¹‰à¸§à¸™

### v2.0.0
- âœ¨ à¸›à¸£à¸±à¸šà¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸›à¹‡à¸™ Modular Architecture
- âœ¨ à¹€à¸à¸´à¹ˆà¸¡ Configuration Management
- âœ¨ à¸£à¸­à¸‡à¸£à¸±à¸š Cross-platform
- âœ¨ à¹€à¸à¸´à¹ˆà¸¡ Command Line Interface
- âœ¨ à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡ Error Handling

### v1.0.0
- ğŸ‰ Initial release
- âœ… FI Revenue Expense Processing
- âœ… Revenue ETL Pipeline
- âœ… Basic Reconciliation

---

## ğŸ“ Support & Contact

### à¸à¸²à¸£à¸£à¸²à¸¢à¸‡à¸²à¸™à¸›à¸±à¸à¸«à¸²
à¸«à¸²à¸à¸à¸šà¸›à¸±à¸à¸«à¸²à¸«à¸£à¸·à¸­à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­:

1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š [Troubleshooting](#-troubleshooting) à¸”à¹‰à¸²à¸™à¸šà¸™
2. à¸”à¸¹ log files à¹ƒà¸™ `logs/` directory
3. à¸”à¸¹ reconciliation logs à¹ƒà¸™ `revenue/output/reconcile_logs/`
4. à¸•à¸´à¸”à¸•à¹ˆà¸­à¸—à¸µà¸¡à¸à¸±à¸’à¸™à¸²

### à¸à¸²à¸£à¸‚à¸­ Feature à¹ƒà¸«à¸¡à¹ˆ
- à¹€à¸›à¸´à¸” issue à¹ƒà¸™ repository
- à¸•à¸´à¸”à¸•à¹ˆà¸­à¸—à¸µà¸¡à¸à¸±à¸’à¸™à¸²à¹‚à¸”à¸¢à¸•à¸£à¸‡

---

## ğŸ“„ License

Copyright Â© 2025 Revenue ETL System. All rights reserved.

**Proprietary Software** - à¸«à¹‰à¸²à¸¡à¸—à¸³à¸‹à¹‰à¸³ à¹à¸ˆà¸à¸ˆà¹ˆà¸²à¸¢ à¸«à¸£à¸·à¸­à¸”à¸±à¸”à¹à¸›à¸¥à¸‡à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸£à¸±à¸šà¸­à¸™à¸¸à¸à¸²à¸•

---

## ğŸ™ Acknowledgments

à¸à¸±à¸’à¸™à¸²à¹‚à¸”à¸¢ Revenue ETL Team
**Version:** 2.1.0
**Last Updated:** November 2025
